



<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
    
    <script language="JavaScript">
  ak = "Y2JjZDg5MzE5YTUwYjYzMTYyNzFmNGMzZDc5OWM2NTc="
</script>
    <meta charset="utf-8">
<link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<meta http-equiv="x-ua-compatible" content="ie=edge">


<meta itemprop="name" content="http4k Serverless Modules">
<meta name="twitter:title" content="http4k Serverless Modules">
<meta property="og:title" content="http4k Serverless Modules" />



<meta name="description" content="Feature overview of the http4k-serverless modules, covering Serverless backends">
<meta property="og:description" content="Feature overview of the http4k-serverless modules, covering Serverless backends" />
<meta name="twitter:description" content="Feature overview of the http4k-serverless modules, covering Serverless backends">



<link rel="canonical" href="https://www.http4k.org/guide/reference/serverless/">



<meta name="author" content="David Denton (@daviddenton), Ivan Sanchez (@s4nchez)">
<meta name="twitter:creator" content="David Denton (@daviddenton), Ivan Sanchez (@s4nchez)">




<meta name="lang:clipboard.copy" content="en">

<meta name="lang:clipboard.copied" content="en">

<meta name="lang:search.language" content="en">

<meta name="lang:search.pipeline.stopwords" content="en">

<meta name="lang:search.pipeline.trimmer" content="en">

<meta name="lang:search.result.none" content="en">

<meta name="lang:search.result.one" content="en">

<meta name="lang:search.result.other" content="en">

<meta name="lang:search.tokenizer" content="en">

<!-- ****** faviconit.com favicons ****** -->
<link rel="shortcut icon" href="/img/favicon.ico">
<link rel="icon" sizes="16x16 32x32 64x64" href="/img/favicon.ico">
<link rel="icon" type="image/png" sizes="196x196" href="/img/favicon-192.png">
<link rel="icon" type="image/png" sizes="160x160" href="/img/favicon-160.png">
<link rel="icon" type="image/png" sizes="96x96" href="/img/favicon-96.png">
<link rel="icon" type="image/png" sizes="64x64" href="/img/favicon-64.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16.png">
<link rel="apple-touch-icon" href="/img/favicon-57.png">
<link rel="apple-touch-icon" sizes="114x114" href="/img/favicon-114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/img/favicon-72.png">
<link rel="apple-touch-icon" sizes="144x144" href="/img/favicon-144.png">
<link rel="apple-touch-icon" sizes="60x60" href="/img/favicon-60.png">
<link rel="apple-touch-icon" sizes="120x120" href="/img/favicon-120.png">
<link rel="apple-touch-icon" sizes="76x76" href="/img/favicon-76.png">
<link rel="apple-touch-icon" sizes="152x152" href="/img/favicon-152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/img/favicon-180.png">
<meta name="msapplication-TileColor" content="#FFFFFF">
<meta name="msapplication-TileImage" content="/img/favicon-144.png">
<meta name="msapplication-config" content="/img/browserconfig.xml">
<!-- ****** faviconit.com favicons ****** -->
<meta name="generator" content="mkdocs-1.2.3, mkdocs-material-3.0.4">
    
    
    
    <title>http4k Serverless Modules</title>
    
    
    
    
    
    
    <meta name="theme-color" content="#4051b5">
    
    
    
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/codehilite.css"/>
    
    
    
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&amp;display=swap" rel="stylesheet"/>
    
    
    <link rel="stylesheet" href="/css/main.css"/>
    
    <link rel="stylesheet" href="../../../css/site.css">
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
</head>



<body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="blue">







<div class="intro">
    <div class="row no-gutters justify-content-center">
        <div class="aside col-auto">
    <img class="mb-3 sideToggle d-inline-block d-md-none" src="/img/exchange-icon.svg" width="20" alt="" srcset=""/>
    <a href="/">
        <div class="logo"><img src="/img/logo-intro.png" width="185" alt="logo" srcset=""/></div>
    </a>
    <ul class="nav flex-column">
        
        
        
        
    
        <li class="nav-item">
            <a class="nav-link "
               href="../../../documentation/"
               title="Introduction">Introduction</a>
        </li>
    

        
        
        
        
    
        <li class="nav-item">
            <a class="nav-link "
               href="../../../quickstart/"
               title="Quickstart">Quickstart</a>
        </li>
    

        
        
        
        
    
        <li class="nav-item">
            <a class="nav-link "
               href="../../"
               title="About the docs">About the docs</a>
        </li>
    

        
        
        
        
    
        <li class="nav-item dropdown ">
            <a class="nav-link dropdown-toggle "
               data-toggle="dropdown"
               href="#"
               role="button"
               aria-haspopup="true"
               aria-expanded="false">Concepts</a>
            <div class="dropdown-menu ">
            
            
            
    
        <a class="dropdown-item "
           href="../../concepts/rationale/"
           title="Rationale">Rationale</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../concepts/http/"
           title="HTTP">HTTP</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../concepts/serverless/"
           title="Serverless">Serverless</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../concepts/websockets/"
           title="WebSockets">WebSockets</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../concepts/server-sent-events/"
           title="Server-Sent Events">Server-Sent Events</a>
    

            
            </div>
        </li>
    

        
        
        
        
    
        <li class="nav-item dropdown ">
            <a class="nav-link dropdown-toggle "
               data-toggle="dropdown"
               href="#"
               role="button"
               aria-haspopup="true"
               aria-expanded="false">Tutorials</a>
            <div class="dropdown-menu ">
            
            
            
    
        <a class="dropdown-item "
           href="../../tutorials/your_first_http4k_app/"
           title="Your first http4k app">Your first http4k app</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../tutorials/serverless_http4k_with_aws_lambda/"
           title="Deploying an http4k app to AWS Lambda">Deploying an http4k app to AWS Lambda</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../tutorials/going_native_with_graal_on_aws_lambda/"
           title="Going native with Graal on AWS Lambda">Going native with Graal on AWS Lambda</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../tutorials/tdding_http4k/"
           title="TDDing http4k">TDDing http4k</a>
    

            
            </div>
        </li>
    

        
        
        
        
    
        <li class="nav-item dropdown ">
            <a class="nav-link dropdown-toggle "
               data-toggle="dropdown"
               href="#"
               role="button"
               aria-haspopup="true"
               aria-expanded="false">How-to guides</a>
            <div class="dropdown-menu ">
            
            
            
    
        <a class="dropdown-item "
           href="../../howto/"
           title="Overview">Overview</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/server_as_a_function/"
           title="Basic: Server as a function">Basic: Server as a function</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/client_as_a_function/"
           title="Basic: Client as a function">Basic: Client as a function</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/use_a_server_backend/"
           title="Basic: Use a Server backend">Basic: Use a Server backend</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/write_different_test_types/"
           title="Basic: Different test-types">Basic: Different test-types</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/simple_routing/"
           title="Basic: Simple routing">Basic: Simple routing</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/nestable_routes/"
           title="Basic: Nestable routes">Basic: Nestable routes</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/attach_context_to_a_request/"
           title="Attach context to a request">Attach context to a request</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/configure_an_oauth_server/"
           title="Configure an OAuth Server">Configure an OAuth Server</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/create_a_custom_json_marshaller/"
           title="Create a custom JSON marshaller">Create a custom JSON marshaller</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/customise_a_server_backend/"
           title="Customise a Server backend">Customise a Server backend</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/deploy_webjars/"
           title="Deploy WebJars">Deploy WebJars</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/integrate_with_openapi/"
           title="Integrate with OpenAPI">Integrate with OpenAPI</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/leverage_graphql/"
           title="Leverage GraphQL">Leverage GraphQL</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/lookup_a_user_principal/"
           title="Lookup a User Principal">Lookup a User Principal</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/monitor_http4k/"
           title="Monitor http4k">Monitor http4k</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/record_and_replay_http_traffic/"
           title="Record & replay HTTP traffic">Record & replay HTTP traffic</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/serve_sse/"
           title="Serve Server-Sent Events">Serve Server-Sent Events</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/serve_websockets/"
           title="Serve Websockets">Serve Websockets</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/structure_your_logs_with_events/"
           title="Structure your logs with Events">Structure your logs with Events</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/test_using_service_virtualisation/"
           title="Test using Service Virtualisation">Test using Service Virtualisation</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/typesafe_your_api_with_lenses/"
           title="Typesafe your API with lenses">Typesafe your API with lenses</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/secure_and_auth_http/"
           title="Secure and auth HTTP services">Secure and auth HTTP services</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/use_a_custom_oauth_provider/"
           title="Use a custom OAuth Provider">Use a custom OAuth Provider</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/use_a_templating_engine/"
           title="Use a templating engines">Use a templating engines</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/use_html_forms/"
           title="Use HTML forms">Use HTML forms</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/use_multipart_forms/"
           title="Use Multipart forms">Use Multipart forms</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/self_document_systems_with_tests/"
           title="Self document systems with tests">Self document systems with tests</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/use_auto_content_negotiation/"
           title="Use Auto Content Negotiation">Use Auto Content Negotiation</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/create_a_swagger_ui/"
           title="Create a Swagger UI">Create a Swagger UI</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../howto/moshi_lite/"
           title="Use Moshi with "lite" Reflection">Use Moshi with "lite" Reflection</a>
    

            
            </div>
        </li>
    

        
        
        
        
    
        <li class="nav-item dropdown active show">
            <a class="nav-link dropdown-toggle active"
               data-toggle="dropdown"
               href="#"
               role="button"
               aria-haspopup="true"
               aria-expanded="true">Reference</a>
            <div class="dropdown-menu show">
            
            
            
    
        <a class="dropdown-item "
           href="../"
           title="Overview">Overview</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../../api/"
           title="API docs">API docs</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../core/"
           title="Core">Core</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../servers/"
           title="Server backend">Server backend</a>
    

            
            
            
    
        <a class="dropdown-item active"
           href="./"
           title="Serverless backend">Serverless backend</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../clients/"
           title="HTTP & Websocket clients">HTTP & Websocket clients</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../contracts/"
           title="Typesafe contracts (OpenAPI3)">Typesafe contracts (OpenAPI3)</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../json/"
           title="JSON handling">JSON handling</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../templating/"
           title="Templating">Templating</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../multipart/"
           title="Multipart forms">Multipart forms</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../cloud_native/"
           title="Cloud Native Configuration">Cloud Native Configuration</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../cloud_events/"
           title="Cloud Events">Cloud Events</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../micrometer/"
           title="Micrometer">Micrometer</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../opentelemetry/"
           title="OpenTelemetry">OpenTelemetry</a>
    

            
            
            
    
        <a class="dropdown-item nav-link dropdown-toggle  "
            data-toggle="dropdown"
            href="#"
            role="button"
            aria-haspopup="true"
            aria-expanded="false"> Fault Tolerance</a>
        <div class="dropdown-menu ">
            
            
            
    
        <a class="dropdown-item "
           href="../resilience4j/"
           title="Resilience4J">Resilience4J</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../failsafe/"
           title="Failsafe">Failsafe</a>
    

            
        </div>
    

            
            
            
    
        <a class="dropdown-item "
           href="../aws/"
           title="AWS">AWS</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../oauth/"
           title="OAuth">OAuth</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../graphql/"
           title="GraphQL">GraphQL</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../jsonrpc/"
           title="JSON RPC">JSON RPC</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../xml/"
           title="XML handling">XML handling</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../yaml/"
           title="YAML handling">YAML handling</a>
    

            
            
            
    
        <a class="dropdown-item nav-link dropdown-toggle  "
            data-toggle="dropdown"
            href="#"
            role="button"
            aria-haspopup="true"
            aria-expanded="false"> Testing</a>
        <div class="dropdown-menu ">
            
            
            
    
        <a class="dropdown-item "
           href="../testing/"
           title="Overview">Overview</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../approvaltests/"
           title="Approval Testing">Approval Testing</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../chaos/"
           title="Chaos Testing">Chaos Testing</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../hamkrest/"
           title="Hamkrest">Hamkrest</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../kotest/"
           title="Kotest">Kotest</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../servicevirtualisation/"
           title="Service Virtualisation">Service Virtualisation</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../strikt/"
           title="Strikt">Strikt</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../webdriver/"
           title="WebDriver">WebDriver</a>
    

            
        </div>
    

            
            </div>
        </li>
    

        
        
        
        
    
        <li class="nav-item dropdown ">
            <a class="nav-link dropdown-toggle "
               data-toggle="dropdown"
               href="#"
               role="button"
               aria-haspopup="true"
               aria-expanded="false">Blog</a>
            <div class="dropdown-menu ">
            
            
            
    
        <a class="dropdown-item "
           href="../../../blog/"
           title="Overview">Overview</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../../blog/meet_http4k/"
           title="Meet http4k">Meet http4k</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../../blog/typesafe_websockets/"
           title="Typesafe Websockets">Typesafe Websockets</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../../blog/typesafe_configuration/"
           title="Typesafe 12-factor config">Typesafe 12-factor config</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../../blog/documenting_apis_with_openapi/"
           title="Documenting http4k apps with OpenApi3">Documenting http4k apps with OpenApi3</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../../blog/retrospective_v3/"
           title="Retrospective on v3">Retrospective on v3</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../../blog/nanoservices/"
           title="Nanoservices">Nanoservices</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../../blog/toolbox/"
           title="Toolbox: Guns for show, knives for a pro">Toolbox: Guns for show, knives for a pro</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../../blog/http4k_v4/"
           title="http4k v4 - 17 platforms and counting...">http4k v4 - 17 platforms and counting...</a>
    

            
            
            
    
        <a class="dropdown-item "
           href="../../../blog/regarding_jcenter/"
           title="JCenter Shutdown">JCenter Shutdown</a>
    

            
            </div>
        </li>
    

        
        
        
        
    
        <li class="nav-item">
            <a class="nav-link "
               href="../../../changelog/"
               title="Changelog">Changelog</a>
        </li>
    

        
        
        
        
    
        <li class="nav-item">
            <a class="nav-link "
               href="../../../in_action/"
               title="http4k in action">http4k in action</a>
        </li>
    

        
        
        
        
    
        <li class="nav-item">
            <a class="nav-link "
               href="../../../performance/"
               title="Performance">Performance</a>
        </li>
    

        
        
        
        
    
        <li class="nav-item">
            <a class="nav-link "
               href="../../../faq/"
               title="FAQ">FAQ</a>
        </li>
    

        
        
        
        
    
        <li class="nav-item">
            <a class="nav-link "
               href="../../../support/"
               title="Getting support">Getting support</a>
        </li>
    

        
        
        
        
    
        <li class="nav-item">
            <a class="nav-link "
               href="../../../contributing/"
               title="Contribute/support http4k">Contribute/support http4k</a>
        </li>
    

        
        
        
        
    
        <li class="nav-item">
            <a class="nav-link "
               href="../../../code-of-conduct/"
               title="Code of Conduct">Code of Conduct</a>
        </li>
    

        
        <li class="nav-item">
            <a class="nav-link" href="https://github.com/http4k/http4k">
                <img src="/img/GitHub-Mark-black.png" width="28" alt="See source on GitHub">&nbsp;&nbsp;Source Code</a>
        </li>
    </ul>
</div>
        <main class="col">
          <div class="container">
                <div class="searchBox">
                  <img class="searchBoxIcon" src="/img/search-icon.svg" width="20" alt="" srcset=""/>
                  <input id="search" type="text" />
                </div>
                <div class="content">
                    <img class="mb-3 sideToggle" src="/img/exchange-icon.svg" width="20" alt="" srcset=""/>
                    
                    
                    <h1>Serverless backend</h1>
                    
                    <h3 id="installation_gradle">Installation (Gradle)<a class="headerlink" href="#installation_gradle" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// AWS Lambda: </span>
<span class="n">implementation</span><span class="w"> </span><span class="nl">group:</span><span class="w"> </span><span class="s2">&quot;org.http4k&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;http4k-serverless-lambda&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;4.39.0.0&quot;</span>

<span class="c1">// Google Cloud Functions: </span>
<span class="n">implementation</span><span class="w"> </span><span class="nl">group:</span><span class="w"> </span><span class="s2">&quot;org.http4k&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;http4k-serverless-gcf&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;4.39.0.0&quot;</span>

<span class="c1">// Apache OpenWhisk (IBM Cloud Functions): </span>
<span class="n">implementation</span><span class="w"> </span><span class="nl">group:</span><span class="w"> </span><span class="s2">&quot;org.http4k&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;http4k-serverless-openwhisk&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;4.39.0.0&quot;</span>

<span class="c1">// Azure Functions: </span>
<span class="n">implementation</span><span class="w"> </span><span class="nl">group:</span><span class="w"> </span><span class="s2">&quot;org.http4k&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;http4k-serverless-azure&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;4.39.0.0&quot;</span>

<span class="c1">// Alibaba Function Compute: </span>
<span class="n">implementation</span><span class="w"> </span><span class="nl">group:</span><span class="w"> </span><span class="s2">&quot;org.http4k&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;http4k-serverless-alibaba&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;4.39.0.0&quot;</span>

<span class="c1">// Tencent Serverless Cloud Functions: </span>
<span class="n">implementation</span><span class="w"> </span><span class="nl">group:</span><span class="w"> </span><span class="s2">&quot;org.http4k&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;http4k-serverless-tencent&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;4.39.0.0&quot;</span>
</code></pre></div>

<h3 id="about">About<a class="headerlink" href="#about" title="Permanent link">&para;</a></h3>
<p>These modules provide integration with Serverless deployment environments, such as AWS Lambda or Google Cloud Functions by implementing a single interface. </p>
<h4 id="aws_lambda_integration_http_apps">AWS Lambda integration (HTTP apps)<a class="headerlink" href="#aws_lambda_integration_http_apps" title="Permanent link">&para;</a></h4>
<p>Since http4k is server independent, it turns out to be fairly trivial to deploy full applications to <a href="https://aws.amazon.com/lambda">AWS Lambda</a>, and then call them by setting up the <a href="https://aws.amazon.com/api-gateway">API Gateway</a> to proxy requests to the function. Effectively, the combination of these two services become just another Server back-end supported by the library. This has the added bonus that you can test your applications in a local environment and then simply deploy them to AWS Lambda via S3 upload.</p>
<p>In order to achieve this, only a single interface <code>AppLoader</code> needs to be implemented and a simple extension of <code>AwsLambdaFunction</code> supplied depending on which invocation type is required - Direct, ApiGateway V1/2 or ApplicationLoadBalancer.</p>
<p>This is far from a complete guide, but configuring AWS Lambda and the API Gateway involves several stages:</p>
<ol>
<li>Users, Roles and Policies for the API Gateway and Lambda.</li>
<li>API Gateway to proxy all requests to your Lambda.</li>
<li>Building your http4k application into a standard UberJar.</li>
<li>Optionally using Proguard to minify the JAR.</li>
<li>Package up the (minified) JAR into a standard Zip distribution.</li>
<li>Create and configure the Lambda function, and at the same time:<ul>
<li>Upload the standard Zip file to S3.</li>
<li>Set the function execution to call the main http4k entry point: <code>guide.modules.serverless.lambda.FunctionsExampleEntryClass</code></li>
</ul>
</li>
</ol>
<p>We hope to soon provide some tools to automate at least some of the above process, or at least document it somewhat. However, AWS is a complicated beast and many people have a preferred way to set it up: CloudFormation templates, Serverless framework, Terraform, etc. In the meantime, here is an example of how the <code>AppLoader</code> is created and how to launch the app locally:</p>
<h4 id="code">Code <a href="https://github.com/http4k/http4k/blob/master/src/docs/guide/reference/serverless/lambda/example.kt"><img class="octocat"/></a><a class="headerlink" href="#code" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">guide.reference.serverless.lambda</span>

<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.client.ApacheClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.HttpHandler</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Method.POST</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Request</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Response</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Status.Companion.OK</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.server.SunHttp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.server.asServer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.ApiGatewayV1LambdaFunction</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.AppLoader</span>
<span class="k">import</span><span class="w"> </span><span class="nn">java.lang.reflect.Proxy</span>

<span class="c1">// This AppLoader is responsible for building our HttpHandler which is supplied to AWS</span>
<span class="c1">// It is the only actual piece of code that needs to be written.</span>
<span class="kd">object</span><span class="w"> </span><span class="nc">TweetEchoLambda</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AppLoader</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">env</span><span class="p">:</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="n">HttpHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Response</span><span class="p">(</span><span class="n">OK</span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="nb">it</span><span class="p">.</span><span class="na">bodyString</span><span class="p">().</span><span class="na">take</span><span class="p">(</span><span class="m">17</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// This class is the entry-point for the function call - configure it when deploying</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">FunctionsExampleEntryClass</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ApiGatewayV1LambdaFunction</span><span class="p">(</span><span class="n">TweetEchoLambda</span><span class="p">)</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Launching your Lambda Function locally - by simply providing the operating ENVIRONMENT map as would</span>
<span class="w">    </span><span class="c1">// be configured on AWS.</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">runLambdaLocally</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;RUNNING LOCALLY:&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">app</span><span class="p">:</span><span class="w"> </span><span class="n">HttpHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TweetEchoLambda</span><span class="p">(</span><span class="n">mapOf</span><span class="p">())</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">localLambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">app</span><span class="p">.</span><span class="na">asServer</span><span class="p">(</span><span class="n">SunHttp</span><span class="p">(</span><span class="m">8000</span><span class="p">)).</span><span class="na">start</span><span class="p">()</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ApacheClient</span><span class="p">()(</span>
<span class="w">            </span><span class="n">Request</span><span class="p">(</span>
<span class="w">                </span><span class="n">POST</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;http://localhost:8000/&quot;</span>
<span class="w">            </span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;hello hello hello, i suppose this isn&#39;t 140 characters anymore..&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="w">        </span><span class="n">localLambda</span><span class="p">.</span><span class="na">stop</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// the following code is purely here for demonstration purposes, to explain exactly what is happening at AWS.</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">runLambdaAsAwsWould</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;RUNNING AS LAMBDA:&quot;</span><span class="p">)</span>

<span class="c1">//        val response = FunctionsExampleEntryClass().handleRequest(ServerlessMoshi.asInputStream(</span>
<span class="c1">//            mapOf(</span>
<span class="c1">//                &quot;path&quot; to &quot;/&quot;,</span>
<span class="c1">//                &quot;queryStringParameters&quot; to emptyMap&lt;String, String&gt;(),</span>
<span class="c1">//                &quot;body&quot; to &quot;hello hello hello, i suppose this isn&#39;t 140 characters anymore..&quot;,</span>
<span class="c1">//                &quot;headers&quot; to emptyMap&lt;String, String&gt;(),</span>
<span class="c1">//                &quot;isBase64Encoded&quot; to false,</span>
<span class="c1">//                &quot;httpMethod&quot; to &quot;GET&quot;</span>
<span class="c1">//            )</span>
<span class="c1">//        ), proxy())</span>
<span class="c1">//        println(response)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">runLambdaLocally</span><span class="p">()</span>
<span class="w">    </span><span class="n">runLambdaAsAwsWould</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">// helper method to stub the Lambda Context</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">inline</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="k">reified</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">proxy</span><span class="p">():</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Proxy</span><span class="p">.</span><span class="na">newProxyInstance</span><span class="p">(</span>
<span class="w">    </span><span class="n">T</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">java</span><span class="p">.</span><span class="na">classLoader</span><span class="p">,</span>
<span class="w">    </span><span class="n">arrayOf</span><span class="p">(</span><span class="n">T</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">java</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">TODO</span><span class="p">(</span><span class="s">&quot;not implemented&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span>
</code></pre></div>

<h4 id="aws_lambda_integration_event-based_apps">AWS Lambda integration (Event-based apps)<a class="headerlink" href="#aws_lambda_integration_event-based_apps" title="Permanent link">&para;</a></h4>
<p>http4k also supports writing Event-based functions to receive AWS events from services like SQS and Dynamo. One advantage of using http4k version is that it uses the AWS SDK RequestStreamHandler instead of the standard RequestHandler - which avoids the heavyweight Jackson deserialisation process (we use Moshi under the covers) utilised by the standard AWS runtime. To use this events functionality, you should also import the AWS Events JAR:</p>
<div class="codehilite"><pre><span></span><code><span class="n">implementation</span><span class="w"> </span><span class="s2">&quot;com.amazonaws:aws-lambda-java-events:3.8.0&quot;</span>
</code></pre></div>

<p>Similarly to HttpHandler, for event processing in a functional style, the main body of the Lambda function is encapsulated in a single interface <code>FnHandler</code>. This typesafe class is created by an <code>FnLoader</code> function and simply passed into an extension of <code>AwsLambdaEventFunction</code> - which is the class configured as the entry point of your AWS lambda.</p>
<p>The process of configuration is the same as for HTTP apps above.</p>
<h4 id="code_1">Code <a href="https://github.com/http4k/http4k/blob/master/http4k-serverless/lambda/src/examples/kotlin/example_event_handling.kt"><img class="octocat"/></a><a class="headerlink" href="#code_1" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nn">com.amazonaws.services.lambda.runtime.Context</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com.amazonaws.services.lambda.runtime.events.SQSEvent</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com.amazonaws.services.lambda.runtime.events.SQSEvent.SQSMessage</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.client.JavaHttpClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.HttpHandler</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Method.POST</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Request</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Response</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Status.Companion.OK</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.format.AwsLambdaMoshi</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.server.SunHttp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.server.asServer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.AwsLambdaEventFunction</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.FnHandler</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.FnLoader</span>
<span class="k">import</span><span class="w"> </span><span class="nn">java.io.ByteArrayOutputStream</span>
<span class="k">import</span><span class="w"> </span><span class="nn">java.lang.reflect.Proxy</span>

<span class="c1">// This is the handler for the incoming AWS SQS event. It&#39;s just a function so you can call it without any infrastructure</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">EventFnHandler</span><span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="w"> </span><span class="n">HttpHandler</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FnHandler</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">SQSEvent</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">:</span><span class="w"> </span><span class="n">Context</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">e</span><span class="p">.</span><span class="na">records</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">http</span><span class="p">(</span><span class="n">Request</span><span class="p">(</span><span class="n">POST</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;http://localhost:8080/&quot;</span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="nb">it</span><span class="p">.</span><span class="na">body</span><span class="p">.</span><span class="na">reversed</span><span class="p">()))</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="s">&quot;processed </span><span class="si">${</span><span class="n">e</span><span class="p">.</span><span class="na">records</span><span class="p">.</span><span class="na">size</span><span class="si">}</span><span class="s"> messages&quot;</span>
<span class="p">}</span>

<span class="c1">// The FnLoader is responsible for constructing the handler and for handling the serialisation of the request and response</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">EventFnLoader</span><span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="w"> </span><span class="n">HttpHandler</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FnLoader</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">env</span><span class="p">:</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="n">EventFnHandler</span><span class="p">(</span><span class="n">http</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// This class is the entry-point for the Lambda function call - configure it when deploying</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">EventFunction</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AwsLambdaEventFunction</span><span class="p">(</span><span class="n">EventFnLoader</span><span class="p">(</span><span class="n">JavaHttpClient</span><span class="p">()))</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// this server receives the reversed event</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">receivingServer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w"> </span><span class="n">Request</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="na">bodyString</span><span class="p">())</span>
<span class="w">        </span><span class="n">Response</span><span class="p">(</span><span class="n">OK</span><span class="p">)</span>
<span class="w">    </span><span class="p">}.</span><span class="na">asServer</span><span class="p">(</span><span class="n">SunHttp</span><span class="p">(</span><span class="m">8080</span><span class="p">)).</span><span class="na">start</span><span class="p">()</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">sqsEvent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SQSEvent</span><span class="p">().</span><span class="na">apply</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span>
<span class="w">            </span><span class="n">SQSMessage</span><span class="p">().</span><span class="na">apply</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hello world&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">            </span><span class="n">SQSMessage</span><span class="p">().</span><span class="na">apply</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;goodbye world&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">runLambdaInMemoryOrForTesting</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;RUNNING In memory:&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EventFnHandler</span><span class="p">(</span><span class="n">JavaHttpClient</span><span class="p">())</span>
<span class="w">        </span><span class="n">app</span><span class="p">(</span><span class="n">sqsEvent</span><span class="p">,</span><span class="w"> </span><span class="n">proxy</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">runLambdaAsAwsWould</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;RUNNING as AWS would invoke the function:&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ByteArrayOutputStream</span><span class="p">()</span>

<span class="w">        </span><span class="n">EventFunction</span><span class="p">().</span><span class="na">handleRequest</span><span class="p">(</span><span class="n">AwsLambdaMoshi</span><span class="p">.</span><span class="na">asInputStream</span><span class="p">(</span><span class="n">sqsEvent</span><span class="p">),</span><span class="w"> </span><span class="k">out</span><span class="p">,</span><span class="w"> </span><span class="n">proxy</span><span class="p">())</span>

<span class="w">        </span><span class="c1">// the response is empty b</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="k">out</span><span class="p">.</span><span class="na">toString</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">runLambdaInMemoryOrForTesting</span><span class="p">()</span>
<span class="w">    </span><span class="n">runLambdaAsAwsWould</span><span class="p">()</span>

<span class="w">    </span><span class="n">receivingServer</span><span class="p">.</span><span class="na">stop</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">// helper method to stub the Lambda Context</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">inline</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="o">&lt;</span><span class="k">reified</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">proxy</span><span class="p">():</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Proxy</span><span class="p">.</span><span class="na">newProxyInstance</span><span class="p">(</span>
<span class="w">    </span><span class="n">T</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">java</span><span class="p">.</span><span class="na">classLoader</span><span class="p">,</span>
<span class="w">    </span><span class="n">arrayOf</span><span class="p">(</span><span class="n">T</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">java</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">TODO</span><span class="p">(</span><span class="s">&quot;not implemented&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span>
</code></pre></div>

<h4 id="google_cloud_functions_integration">Google Cloud Functions integration<a class="headerlink" href="#google_cloud_functions_integration" title="Permanent link">&para;</a></h4>
<p>Google Cloud Functions are triggered in the cloud by calling an entry point class which implements their <code>HttpFunction</code> interface.</p>
<p>In order to achieve this in http4k, only a single interface <code>AppLoader</code> needs to be implemented, and then a simple extension class needs to be written which accepts this interface.</p>
<p>You can compose filters and handlers as usual and pass them to the constructor of the <code>GoogleCloudFunction</code> and make your entry point class extend from it.
Here is an example:</p>
<h4 id="code_2">Code <a href="https://github.com/http4k/http4k/blob/master/src/docs/guide/reference/serverless/gcf/example.kt"><img class="octocat"/></a><a class="headerlink" href="#code_2" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">guide.reference.serverless.gcf</span>

<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.client.ApacheClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Filter</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.HttpHandler</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Method.POST</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Request</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Response</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Status.Companion.OK</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.then</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.routing.bind</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.routing.routes</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.server.SunHttp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.server.asServer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.AppLoader</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.FakeGCFRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.FakeGCFResponse</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.GoogleCloudHttpFunction</span>

<span class="c1">// This AppLoader is responsible for building our HttpHandler which is supplied to GCF</span>
<span class="c1">// Along with the extension class below, is the only actual piece of code that needs to be written.</span>
<span class="kd">object</span><span class="w"> </span><span class="nc">TweetEchoLambda</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AppLoader</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Filter</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">next</span><span class="p">:</span><span class="w"> </span><span class="n">HttpHandler</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">request</span><span class="p">:</span><span class="w"> </span><span class="n">Request</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">latency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span>
<span class="w">            </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;I took </span><span class="si">$</span><span class="n">latency</span><span class="s"> ms&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">response</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">env</span><span class="p">:</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="n">HttpHandler</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">timer</span>
<span class="w">            </span><span class="p">.</span><span class="na">then</span><span class="p">(</span>
<span class="w">                </span><span class="n">routes</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;/echo&quot;</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">POST</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Response</span><span class="p">(</span><span class="n">OK</span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="nb">it</span><span class="p">.</span><span class="na">bodyString</span><span class="p">().</span><span class="na">take</span><span class="p">(</span><span class="m">18</span><span class="p">))</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// This class is the entry-point for the function call - configure it when deploying</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">FunctionsExampleEntryClass</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">GoogleCloudHttpFunction</span><span class="p">(</span><span class="n">TweetEchoLambda</span><span class="p">)</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// Launching your Function locally - by simply providing the operating ENVIRONMENT map as would</span>
<span class="w">    </span><span class="c1">// be configured in GCP.</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">runFunctionLocally</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;RUNNING LOCALLY:&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">app</span><span class="p">:</span><span class="w"> </span><span class="n">HttpHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TweetEchoLambda</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getenv</span><span class="p">())</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">localLambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">app</span><span class="p">.</span><span class="na">asServer</span><span class="p">(</span><span class="n">SunHttp</span><span class="p">(</span><span class="m">8000</span><span class="p">)).</span><span class="na">start</span><span class="p">()</span>

<span class="w">        </span><span class="n">println</span><span class="p">(</span>
<span class="w">            </span><span class="n">ApacheClient</span><span class="p">()(</span>
<span class="w">                </span><span class="n">Request</span><span class="p">(</span>
<span class="w">                    </span><span class="n">POST</span><span class="p">,</span>
<span class="w">                    </span><span class="s">&quot;http://localhost:8000/echo&quot;</span>
<span class="w">                </span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;hello hello hello, i suppose this isn&#39;t 140 characters anymore..&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">localLambda</span><span class="p">.</span><span class="na">stop</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// the following code is purely here for demonstration purposes, to explain exactly what is happening at GCP.</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">runFunctionAsGCFWould</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;RUNNING AS GCF:&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FakeGCFResponse</span><span class="p">()</span>
<span class="w">        </span><span class="n">FunctionsExampleEntryClass</span><span class="p">().</span><span class="na">service</span><span class="p">(</span>
<span class="w">            </span><span class="n">FakeGCFRequest</span>
<span class="w">                </span><span class="p">(</span>
<span class="w">                </span><span class="n">Request</span><span class="p">(</span>
<span class="w">                    </span><span class="n">POST</span><span class="p">,</span>
<span class="w">                    </span><span class="s">&quot;http://localhost:8000/echo&quot;</span>
<span class="w">                </span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;hello hello hello, i suppose this isn&#39;t 140 characters anymore..&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">),</span><span class="w"> </span><span class="n">response</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">status</span><span class="p">)</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">headers</span><span class="p">)</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">body</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">runFunctionLocally</span><span class="p">()</span>
<span class="w">    </span><span class="n">runFunctionAsGCFWould</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>

<p>If you are using gradle, gcloud can't deploy the function directly from the project, you must build the fat jar first.
Applying this plugin <a href="https://imperceptiblethoughts.com/shadow/">shadow jar</a> will provide you with appropriate gradle task to build the fat jar.</p>
<p>After building, and having your jar as the only file in the <code>libs/</code> folder you can deploy the function from the parent folder with : </p>
<p><code>gcloud functions deploy example-function --runtime=java11 --entry-point=guide.modules.serverless.gcf.FunctionsExampleEntryClass --trigger-http --source=libs/</code></p>
<p>If you wan't to invoke functions locally you can do it with this gradle setup and passing a <code>-PrunFunction.target</code> parameter to the build task : </p>
<div class="codehilite"><pre><span></span><code><span class="n">configurations</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">invoker</span>
<span class="o">}</span>

<span class="n">dependencies</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">invoker</span><span class="w"> </span><span class="s1">&#39;com.google.cloud.functions.invoker:java-function-invoker:1.0.0-alpha-2-rc5&#39;</span>
<span class="o">}</span>

<span class="n">tasks</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="s2">&quot;runFunction&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">JavaExec</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;com.google.cloud.functions.invoker.runner.Invoker&#39;</span>
<span class="w">    </span><span class="n">classpath</span><span class="o">(</span><span class="n">configurations</span><span class="o">.</span><span class="na">invoker</span><span class="o">)</span>
<span class="w">    </span><span class="n">inputs</span><span class="o">.</span><span class="na">files</span><span class="o">(</span><span class="n">configurations</span><span class="o">.</span><span class="na">runtimeClasspath</span><span class="o">,</span><span class="w"> </span><span class="n">sourceSets</span><span class="o">.</span><span class="na">main</span><span class="o">.</span><span class="na">output</span><span class="o">)</span>
<span class="w">    </span><span class="n">args</span><span class="o">(</span>
<span class="w">            </span><span class="s1">&#39;--target&#39;</span><span class="o">,</span><span class="w"> </span><span class="n">project</span><span class="o">.</span><span class="na">findProperty</span><span class="o">(</span><span class="s1">&#39;runFunction.target&#39;</span><span class="o">),</span>
<span class="w">            </span><span class="s1">&#39;--port&#39;</span><span class="o">,</span><span class="w"> </span><span class="n">project</span><span class="o">.</span><span class="na">findProperty</span><span class="o">(</span><span class="s1">&#39;runFunction.port&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="mi">8080</span>
<span class="w">    </span><span class="o">)</span>
<span class="w">    </span><span class="n">doFirst</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="n">args</span><span class="o">(</span><span class="s1">&#39;--classpath&#39;</span><span class="o">,</span><span class="w"> </span><span class="n">files</span><span class="o">(</span><span class="n">configurations</span><span class="o">.</span><span class="na">runtimeClasspath</span><span class="o">,</span><span class="w"> </span><span class="n">sourceSets</span><span class="o">.</span><span class="na">main</span><span class="o">.</span><span class="na">output</span><span class="o">).</span><span class="na">asPath</span><span class="o">)</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

<p>If you are using Maven, you do not have to build the fat JAR and can deploy the function from the project folder.
Simple example on how to setup <code>pom.xml</code> to run functions locally and deploy Maven project to the cloud is shown <a href="https://cloud.google.com/functions/docs/first-java">here</a></p>
<h4 id="apache_openwhisk_integration">Apache OpenWhisk integration<a class="headerlink" href="#apache_openwhisk_integration" title="Permanent link">&para;</a></h4>
<p>OpenWhisk has a Java runtime which is triggered by calling an entry point class which contains a static <code>main()</code> function receiving a GSON <code>JsonObject</code>.</p>
<p>In order to achieve this in http4k, only a single interface <code>AppLoader</code> needs to be implemented, and then a simple class needs to be written which uses the <code>OpenWhiskFunction</code> wrapper. Because of the OpenWhisk runtime usage of the library, a <code>compileOnly</code> dependency also needs to be added on <a href="https://mvnrepository.com/artifact/com.google.code.gson/gson">GSON</a> to ensure that your function can build correctly.</p>
<h4 id="code_3">Code <a href="https://github.com/http4k/http4k/blob/master/src/docs/guide/reference/serverless/openwhisk/example.kt"><img class="octocat"/></a><a class="headerlink" href="#code_3" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">guide.reference.serverless.openwhisk</span>

<span class="k">import</span><span class="w"> </span><span class="nn">com.google.gson.JsonObject</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.client.ApacheClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Filter</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.HttpHandler</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Method.POST</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Request</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Response</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.Status.Companion.OK</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.core.then</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.format.Gson</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.routing.bind</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.routing.routes</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.server.SunHttp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.server.asServer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.AppLoader</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.FakeOpenWhiskRawRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org.http4k.serverless.OpenWhiskFunction</span>

<span class="c1">// This AppLoader is responsible for building our HttpHandler which is supplied to OpenWhisk</span>
<span class="c1">// Along with the extension class below, is the only actual piece of code that needs to be written.</span>
<span class="kd">object</span><span class="w"> </span><span class="nc">TweetEchoLambda</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AppLoader</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Filter</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">next</span><span class="p">:</span><span class="w"> </span><span class="n">HttpHandler</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">request</span><span class="p">:</span><span class="w"> </span><span class="n">Request</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">latency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span>
<span class="w">            </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;I took </span><span class="si">$</span><span class="n">latency</span><span class="s"> ms&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">response</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">env</span><span class="p">:</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="n">HttpHandler</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">timer</span>
<span class="w">            </span><span class="p">.</span><span class="na">then</span><span class="p">(</span>
<span class="w">                </span><span class="n">routes</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;/echo&quot;</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">POST</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Response</span><span class="p">(</span><span class="n">OK</span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="nb">it</span><span class="p">.</span><span class="na">bodyString</span><span class="p">().</span><span class="na">take</span><span class="p">(</span><span class="m">18</span><span class="p">))</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// This class is the entry-point for the function call - configure it when deploying</span>
<span class="kd">object</span><span class="w"> </span><span class="nc">FunctionsExampleEntryClass</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@JvmStatic</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">request</span><span class="p">:</span><span class="w"> </span><span class="n">JsonObject</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OpenWhiskFunction</span><span class="p">(</span><span class="n">TweetEchoLambda</span><span class="p">)(</span><span class="n">request</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">fun</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// Launching your Function locally - by simply providing the operating ENVIRONMENT map as would</span>
<span class="w">    </span><span class="c1">// be configured in OpenWhisk.</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">runFunctionLocally</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;RUNNING LOCALLY:&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">app</span><span class="p">:</span><span class="w"> </span><span class="n">HttpHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TweetEchoLambda</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getenv</span><span class="p">())</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">localLambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">app</span><span class="p">.</span><span class="na">asServer</span><span class="p">(</span><span class="n">SunHttp</span><span class="p">(</span><span class="m">8000</span><span class="p">)).</span><span class="na">start</span><span class="p">()</span>

<span class="w">        </span><span class="n">println</span><span class="p">(</span>
<span class="w">            </span><span class="n">ApacheClient</span><span class="p">()(</span>
<span class="w">                </span><span class="n">Request</span><span class="p">(</span>
<span class="w">                    </span><span class="n">POST</span><span class="p">,</span>
<span class="w">                    </span><span class="s">&quot;http://localhost:8000/echo&quot;</span>
<span class="w">                </span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;hello hello hello, i suppose this isn&#39;t 140 characters anymore..&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">localLambda</span><span class="p">.</span><span class="na">stop</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// the following code is purely here for demonstration purposes, to explain exactly what is happening in OpenWhisk.</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">runFunctionAsOpenWhiskWould</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;RUNNING AS OpenWhisk:&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">fakeOpenWhiskRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FakeOpenWhiskRawRequest</span><span class="p">(</span>
<span class="w">            </span><span class="s">&quot;POST&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/echo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">emptyMap</span><span class="p">(),</span>
<span class="w">            </span><span class="s">&quot;hello hello hello, i suppose this isn&#39;t 140 characters anymore..&quot;</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="n">FunctionsExampleEntryClass</span><span class="p">.</span><span class="na">main</span><span class="p">(</span><span class="n">Gson</span><span class="p">.</span><span class="na">asJsonObject</span><span class="p">(</span><span class="n">fakeOpenWhiskRequest</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">JsonObject</span><span class="p">)</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">runFunctionLocally</span><span class="p">()</span>
<span class="w">    </span><span class="n">runFunctionAsOpenWhiskWould</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>

<p>Packaging of the app should be done using <a href="https://imperceptiblethoughts.com/shadow/">ShadowJar</a> and then an action created with the <code>wsk</code> CLI:</p>
<div class="codehilite"><pre><span></span><code>wsk -i action create myFunctionName myApp.jar --main org.http4k.example.MyFunctionClass --web true
</code></pre></div>

<p>Locally, you can then just call the function with <code>curl</code>:</p>
<div class="codehilite"><pre><span></span><code>curl -k `wsk -i action get test --url | tail -1`
</code></pre></div>
                    
                </div>
            </div>
        </main>
    </div>
</div>
<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.bundle.min.js"></script>
<script src="/js/index-min.js"></script>
<script src="../../../assets/javascripts/toggle-search.js"></script>

      <script src="../../../assets/javascripts/application.583bbe55.js"></script>









<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-125143867-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
  apiKey: atob(ak),
  indexName: 'http4k',
  inputSelector: '#search',
  debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>
</html>